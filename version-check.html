<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Verificaci√≥n de Versi√≥n</title>
    <style>
        body {
            font-family: monospace;
            padding: 40px;
            background: #000;
            color: #0f0;
            font-size: 16px;
        }
        .ok { color: #0f0; }
        .error { color: #f00; }
        .warning { color: #ff0; }
        h1 { text-shadow: 0 0 10px #0f0; }
    </style>
</head>
<body>
    <h1>üîç Verificaci√≥n de Versi√≥n del Sitio</h1>
    <pre id="output">Cargando verificaci√≥n...</pre>
    <script src="js/auth.js"></script>
    <script>
        const output = document.getElementById('output');
        let log = '';

        function addLog(msg, type = 'ok') {
            log += `<span class="${type}">${msg}</span>\n`;
            output.innerHTML = log;
        }

        // Verificar versi√≥n
        addLog('=== VERIFICACI√ìN DE VERSI√ìN ===\n', 'ok');
        addLog(`Timestamp: ${new Date().toISOString()}`, 'ok');
        addLog(`URL: ${window.location.href}\n`, 'ok');

        // Verificar AuthManager
        if (typeof authManager === 'undefined') {
            addLog('‚ùå ERROR: AuthManager NO est√° cargado', 'error');
            addLog('   Esto significa que el archivo NO se actualiz√≥', 'error');
        } else {
            addLog('‚úÖ AuthManager est√° cargado', 'ok');

            if (typeof authManager.initializeUsersSync === 'function') {
                addLog('‚úÖ Versi√≥n CORRECTA detectada (initializeUsersSync existe)', 'ok');
            } else {
                addLog('‚ùå Versi√≥n VIEJA detectada (initializeUsersSync NO existe)', 'error');
                addLog('   GitHub Pages NO se ha actualizado todav√≠a', 'warning');
            }
        }

        // Verificar usuarios
        addLog('\n=== VERIFICACI√ìN DE USUARIOS ===\n', 'ok');
        try {
            const users = authManager.getAllUsers();
            addLog(`‚úÖ Usuarios encontrados: ${users.length}`, 'ok');

            if (users.length === 0) {
                addLog('‚ö†Ô∏è  NO hay usuarios - inicializando...', 'warning');
            } else {
                addLog('\nUsuarios disponibles:', 'ok');
                users.forEach(u => {
                    addLog(`  üìß ${u.email} (${u.rol})`, 'ok');
                });
            }
        } catch (e) {
            addLog(`‚ùå Error al obtener usuarios: ${e.message}`, 'error');
        }

        // Test de login
        addLog('\n=== TEST DE LOGIN AUTOM√ÅTICO ===\n', 'ok');
        authManager.login('admin@seguimiento.com', 'Admin2024!')
            .then(result => {
                if (result.success) {
                    addLog('‚úÖ ¬°LOGIN FUNCION√ì! El sitio est√° actualizado', 'ok');
                    addLog('\nPuedes ir a index.html y hacer login', 'ok');
                } else {
                    addLog(`‚ùå Login fall√≥: ${result.message}`, 'error');
                    if (result.message === 'Usuario no autorizado') {
                        addLog('\n‚ö†Ô∏è  VERSI√ìN VIEJA CONFIRMADA', 'warning');
                        addLog('   GitHub Pages a√∫n no se actualiz√≥', 'warning');
                        addLog('   Espera 5-10 minutos y recarga esta p√°gina', 'warning');
                    }
                }
            })
            .catch(err => {
                addLog(`‚ùå Error cr√≠tico: ${err.message}`, 'error');
            });

        // Instrucciones
        addLog('\n=== INSTRUCCIONES ===\n', 'ok');
        addLog('Si ves "Versi√≥n VIEJA":', 'warning');
        addLog('1. Espera 5-10 minutos', 'warning');
        addLog('2. Recarga esta p√°gina (Ctrl+F5 o Cmd+Shift+R)', 'warning');
        addLog('3. Verifica que diga "Versi√≥n CORRECTA"', 'warning');
        addLog('\nSi ves "Versi√≥n CORRECTA":', 'ok');
        addLog('1. Ve a index.html', 'ok');
        addLog('2. Login: admin@seguimiento.com / Admin2024!', 'ok');
    </script>
</body>
</html>
